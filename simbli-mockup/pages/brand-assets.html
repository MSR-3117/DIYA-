<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Upload your brand assets to DIYA.">
    <title>Brand Assets – DIYA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/brand-assets.css">
</head>

<body>
    <div class="gradient-orb gradient-orb-1"></div>
    <div class="gradient-orb gradient-orb-2"></div>

    <div class="page-wrapper">
        <header class="header">
            <a href="../index.html" class="logo">
                <div class="logo-icon"></div>
                <span class="logo-text">DIYA</span>
            </a>
            <nav class="header-nav">
                <a href="#" class="header-link">Help</a>
            </nav>
        </header>

        <main class="main-content">
            <div class="container">
                <div class="progress-indicator">
                    <div class="progress-dot completed"></div>
                    <div class="progress-line completed"></div>
                    <div class="progress-dot completed"></div>
                    <div class="progress-line completed"></div>
                    <div class="progress-dot active"></div>
                    <div class="progress-line"></div>
                    <div class="progress-dot"></div>
                </div>
                <p class="progress-text">Step 3 of 4</p>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Your brand assets</h2>
                        <p class="card-subtitle">Select your brand colors and upload your logo.</p>
                    </div>

                    <div class="section">
                        <h4 class="section-title">Color Palette</h4>
                        <div class="color-palette" id="colorPalette">
                            <!-- Initial Colors -->
                            <div class="color-swatch-wrapper">
                                <div class="color-swatch selected" data-color="#6C8CFF"
                                    style="background-color: #6C8CFF;"></div>
                            </div>
                            <div class="color-swatch-wrapper">
                                <div class="color-swatch" data-color="#8B5CF6" style="background-color: #8B5CF6;"></div>
                            </div>
                            <div class="color-swatch-wrapper">
                                <div class="color-swatch" data-color="#22C55E" style="background-color: #22C55E;"></div>
                            </div>

                            <!-- Add Button -->
                            <button class="add-color-btn" id="addColorBtn" title="Add Color">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </button>
                        </div>

                        <!-- Hidden Dropdown -->
                        <div class="color-dropdown" id="colorDropdown">
                            <span class="color-dropdown-title">Select Color</span>
                            <div class="color-grid" id="colorGrid">
                                <!-- Generated by JS -->
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h4 class="section-title">Brand Logo</h4>
                        <div class="upload-zone">
                            <div class="upload-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" />
                                </svg>
                            </div>
                            <p class="upload-title">Upload your logo</p>
                            <p class="upload-hint">PNG, SVG, or JPG up to 5MB</p>
                        </div>
                    </div>

                    <div class="footer-actions">
                        <a href="generate-week.html" class="btn btn-primary btn-block btn-lg">Next</a>
                        <div class="footer-actions-row">
                            <a href="content-input.html" class="back-link">← Back</a>
                            <a href="generate-week.html" class="skip-link">Skip for now</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const palette = document.getElementById('colorPalette');
            const addBtn = document.getElementById('addColorBtn');
            const dropdown = document.getElementById('colorDropdown');
            const colorGrid = document.getElementById('colorGrid');

            let activeSwatch = null; // The swatch currently being edited

            // Predefined Colors
            const colors = [
                '#EF4444', '#F97316', '#F59E0B', '#EAB308', '#84CC16',
                '#22C55E', '#10B981', '#14B8A6', '#06B6D4', '#0EA5E9',
                '#3B82F6', '#6366F1', '#8B5CF6', '#A855F7', '#D946EF',
                '#EC4899', '#F43F5E', '#64748B', '#94A3B8', '#0F172A'
            ];

            // 1. Initialize Gradient Picker
            const canvas = document.createElement('canvas');
            canvas.width = 200;
            canvas.height = 150;
            canvas.style.borderRadius = '8px';
            canvas.style.cursor = 'crosshair';
            colorGrid.style.display = 'block'; // Remove grid layout
            colorGrid.appendChild(canvas);

            const ctx = canvas.getContext('2d');

            // Draw Gradient
            function drawGradient() {
                // Horizontal: Hue
                const gradientH = ctx.createLinearGradient(0, 0, canvas.width, 0);
                gradientH.addColorStop(0, 'red');
                gradientH.addColorStop(0.17, 'orange');
                gradientH.addColorStop(0.33, 'yellow');
                gradientH.addColorStop(0.5, 'green');
                gradientH.addColorStop(0.67, 'cyan');
                gradientH.addColorStop(0.83, 'blue');
                gradientH.addColorStop(1, 'magenta');
                ctx.fillStyle = gradientH;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Vertical: Brightness/Saturation overlay
                const gradientV = ctx.createLinearGradient(0, 0, 0, canvas.height);
                gradientV.addColorStop(0, 'rgba(255,255,255,1)');
                gradientV.addColorStop(0.5, 'rgba(255,255,255,0)');
                gradientV.addColorStop(0.5, 'rgba(0,0,0,0)');
                gradientV.addColorStop(1, 'rgba(0,0,0,1)');
                ctx.fillStyle = gradientV;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
            drawGradient();

            // Handle Canvas Click
            canvas.onclick = (e) => {
                e.stopPropagation();
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const pixel = ctx.getImageData(x, y, 1, 1).data;
                const rgbColor = `rgb(${pixel[0]}, ${pixel[1]}, ${pixel[2]})`;
                const hexColor = rgbToHex(pixel[0], pixel[1], pixel[2]);

                if (activeSwatch) {
                    setColor(activeSwatch, hexColor);
                }
                hideDropdown();
            };

            // Helper: RGB to Hex
            function componentToHex(c) {
                const hex = c.toString(16);
                return hex.length == 1 ? "0" + hex : hex;
            }

            function rgbToHex(r, g, b) {
                return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
            }

            // 2. Add New Swatch
            addBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                // Create new swatch
                const wrapper = document.createElement('div');
                wrapper.className = 'color-swatch-wrapper';

                const newSwatch = document.createElement('div');
                newSwatch.className = 'color-swatch';
                newSwatch.style.backgroundColor = '#E2E8F0'; // Default placeholder
                newSwatch.dataset.color = '#E2E8F0';

                wrapper.appendChild(newSwatch);

                // Insert before the add button
                palette.insertBefore(wrapper, addBtn);

                // Immediately open dropdown for new swatch and trigger click 
                activeSwatch = newSwatch;
                showDropdown(newSwatch);
            });

            // 3. Delegation for Swatch Clicks
            palette.addEventListener('click', (e) => {
                const swatch = e.target.closest('.color-swatch');
                if (swatch) {
                    e.stopPropagation();
                    // Toggle selection visual
                    document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('selected'));
                    swatch.classList.add('selected');

                    activeSwatch = swatch;
                    showDropdown(swatch);
                }
            });

            // 4. Utilities
            function setColor(swatch, color) {
                swatch.style.backgroundColor = color;
                swatch.dataset.color = color;
            }

            function showDropdown(targetEl) {
                // Position logic
                const rect = targetEl.getBoundingClientRect();
                const scrollTop = window.scrollY || document.documentElement.scrollTop;

                dropdown.style.top = (rect.bottom + scrollTop + 10) + 'px';
                dropdown.style.left = (rect.left - 20) + 'px'; // Offset slightly

                dropdown.classList.add('active');
            }

            function hideDropdown() {
                dropdown.classList.remove('active');
            }

            // Close on click outside
            document.addEventListener('click', (e) => {
                if (!dropdown.contains(e.target) && !e.target.closest('.color-swatch') && !e.target.closest('.add-color-btn')) {
                    hideDropdown();
                }
            });
        });
    </script>
</body>

</html>